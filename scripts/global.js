function supports_local_storage(){return("localStorage" in window)&&window.localStorage!==null;}var first_hour={start_time:"7 am",listen:function(){$("#first-hour").change(function(){first_hour.start_time=$(this).val();localStorage.setItem("start_time",first_hour.start_time);hours.update();});},retrieve:function(){first_hour.start_time=(localStorage.getItem("start_time"))?localStorage.getItem("start_time"):"7 am";$("#first-hour").val(first_hour.start_time);},hour_only:function(){return parseInt(first_hour.start_time,10);},init:function(){this.retrieve();this.listen();}};var hours={count:0,update:function(){var a=first_hour.hour_only();$(".hour:not(:first)").each(function(d){var e=((a+1+(1*d))%12==0)?"noon":(a+1+(1*d))%12;var b=((a+1+(1*d))/12>=1)?" pm":" am";var c=(e=="noon")?e:e+b;$(this).find(".time").text(c);});},get_count:function(){hours.count=localStorage.getItem("hours");},set_count:function(){hours.count=$(".hour").size();localStorage.setItem("hours",hours.count);},duplicate:function(){var b=$(".hour:last").clone();b.find("input").val("");var a=$(".hour").size()+1;b.find("input").each(function(c){$(this).attr("name",b.find("input").attr("name").replace(/hour-[0-9]+?-task-([0-9])/,"hour-"+a+"-task-"+(c+1)));});$(".hour:last").after(b);hours.update();hours.set_count();},init:function(){this.get_count();this.update();}};var tasks={listen:function(){$(".hour input[type=text]").live("keyup",function(b){var a=$(this).attr("name");var c=$(this).val();localStorage.setItem(a,c);});},remove_last:function(a){if(a.find("input:first").val()===""&&a.find("input:last").val()===""&&$(".hour").size()>2&&($(".hour:last input:first").val()==="")&&$(".hour:last input:last").val()===""){$(".hour:last input").each(function(b){localStorage.removeItem($(this).attr("name"));});$(".hour:last").remove();tasks.remove_last(a.prev());}},last_listen:function(){$(".hour input").live("keyup",function(b){var a=$(".hour:last").prev();tasks.remove_last(a);hours.set_count();});$(".hour:last input").live("keyup",function(a){if($(this).val()!==""&&$(this).siblings("input")!==""){hours.duplicate();}});},retrieve:function(){var b=hours.count-$(".hour").size();for(var a=0;a<b;a++){hours.duplicate();tasks.remove_placeholders();}for(var d=1;d<=hours.count;d++){var c=$(".hour:eq("+(d-1)+")");c.find("input[type=text]").each(function(f){var e=localStorage.getItem($(this).attr("name"));if(e!=null){$(this).val(e);}});}},remove_placeholders:function(){$(".hour input").attr("placeholder","");},init:function(){this.retrieve();this.listen();this.last_listen();}};var session={get:function(){return localStorage.getItem("visited");},current:function(){var a=new Date();return a.getDate();},check:function(){if(session.current()!=session.get()){for(var a=1;a<=hours.count;a++){for(var b=1;b<=2;b++){localStorage.removeItem("hour-"+a+"-task-"+b);}$(".hour:gt(1)").remove();}this.set();hours.set_count();}},set:function(){localStorage.setItem("visited",this.current());},init:function(){this.check();}};$(document).ready(function(){if(supports_local_storage){first_hour.init();hours.init();session.init();tasks.init();}});